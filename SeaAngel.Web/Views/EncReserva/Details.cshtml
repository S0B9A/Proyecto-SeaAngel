@model SeaAngel.Application.DTOs.EncReservaDTO

@{
	ViewData["Title"] = "Factura";
}

<div class="container factura my-5">
	<div class="invoice border rounded p-5 bg-white shadow">
		<!-- ENCABEZADO -->
		<div class="text-center mb-4">
			<h2 class="fw-bold text-uppercase text-primary">Factura</h2>
			<p class="text-muted">Gracias por su compra</p>
		</div>

		<!-- DATOS DEL CLIENTE Y FACTURA -->
		<div class="row g-4">
			<div class="col-md-6">
				<div class="card p-4 border-0 shadow-sm">
					<h5 class="fw-bold text-secondary">Datos del Cliente</h5>
					<p><strong>Nombre:</strong> @Model.IdusuarioNavigation.Nombre</p>
					<p><strong>Teléfono:</strong> @Model.IdusuarioNavigation.Telefono</p>
					<p><strong>Correo:</strong> @Model.IdusuarioNavigation.CorreoElectronico</p>
				</div>
			</div>
			<div class="col-md-6">
				<div class="card p-4 border-0 shadow-sm">
					<h5 class="fw-bold text-secondary">Detalles de la Factura</h5>
					<p><strong>#Reserva:</strong> @Model.Id</p>
					<p><strong>Fecha de Creación:</strong> @(Model.FechaCreacion?.ToString("dd/MM/yyyy") ?? "N/A")</p>
					@if (Model.Estado == "Pendiente")
					{
						<div class="alert alert-warning text-center mt-3">
							<p><strong>Estado de Pago:</strong> Pendiente</p>
							<p><strong>Fecha límite:</strong> @(Model.FechaPago?.ToString("dd/MM/yyyy") ?? "N/A")</p>
						</div>
					}
					else
					{
						<p><strong>Estado de Pago:</strong> <span class="badge bg-success">@Model.Estado</span></p>
					}
				</div>
			</div>
		</div>

		<!-- INFORMACIÓN DEL CRUCERO -->
		<div class="card p-4 mt-4 border-0 shadow-sm">
			<h5 class="fw-bold text-secondary">Datos del Crucero</h5>
			<div class="row">
				<div class="col-md-6">
					<p><strong>Nombre:</strong> @Model.IdfechaNavigation.IdcruceroNavigation.Nombre</p>
					<p><strong>Fecha Inicio:</strong> @Model.IdfechaNavigation.FechaInicio?.ToString("dd/MM/yyyy")</p>
					<p><strong>Cantidad de días:</strong> @Model.IdfechaNavigation.IdcruceroNavigation.CantDias</p>
					<p>
						<strong>Fecha Fin:</strong> @(Model.IdfechaNavigation.FechaInicio?.AddDays(Model.IdfechaNavigation.IdcruceroNavigation.CantDias).ToString("dd/MM/yyyy") ?? "N/A")
					</p>
				</div>
				<div class="col-md-6">
					<h5 class="fw-bold text-secondary">Itinerario</h5>
					@foreach (var itinerario in Model.IdfechaNavigation.IdcruceroNavigation.Itinerario)
					{
						<p><strong>Día:</strong> @itinerario.Dia</p>
						<p><strong>Descripción:</strong> @itinerario.Descripcion</p>
						<p><strong>Puerto:</strong> @itinerario.IdpuertoNavigation.Nombre</p>
						<hr class="my-1">
					}
				</div>
			</div>
		</div>

		<!-- TABLA DE COMPLEMENTOS -->
		<div class="card p-4 mt-4 border-0 shadow-sm">
			<h5 class="fw-bold text-secondary">Complementos</h5>
			<table class="table table-hover text-center">
				<thead class="bg-dark text-white">
					<tr>
						<th>Nombre</th>
						<th>Precio</th>
						<th>Cantidad</th>
						<th>Total</th>
					</tr>
				</thead>
				<tbody>
					@foreach (var complemento in Model.ReservaComplementos)
					{
						<tr>
							<td>@complemento.IdcomplementoNavigation.Nombre</td>
							<td>$@complemento.Precio</td>
							<td>@complemento.Cantidad</td>
							<td>$@(complemento.Precio * complemento.Cantidad)</td>
						</tr>
					}
				</tbody>
			</table>
		</div>

		<!-- DETALLES DEL PAGO -->
		<div class="card p-4 mt-4 border-0 shadow-sm">
			<h5 class="fw-bold text-secondary">Detalles del Pago</h5>
			<table class="table table-hover text-center">
				<thead class="bg-primary text-white">
					<tr>
						<th>Pasajeros</th>
						<th>Camarotes</th>
						<th>Precio/Camarote</th>
						<th>Subtotal</th>
						<th>Impuesto</th>
					</tr>
				</thead>
				<tbody>
					<tr>
						<td>@Model.CantidadDePasajeros</td>
						<td>@Model.CantidadDeCamarotes</td>
						<td>$@Model.PrecioTotalCamorotes</td>
						<td>$@Model.Subtotal</td>
						<td>$@Model.Impuesto</td>
					</tr>
				</tbody>
			</table>
		</div>

		<!-- SECCIÓN DEL TOTAL FINAL -->
		<div class="text-center my-4">
			<div class="alert alert-info">
				<h4 class="fw-bold">Total a Pagar:</h4>
				<p class="display-6 fw-bold text-success">$@Model.PrecioTotal</p>
			</div>
		</div>

		<!-- BOTÓN PARA IMPRIMIR -->
		<div class="text-center mt-4">
			<a class="btn btn-primary" asp-action="GenerarPDF" asp-route-id="@Model.Id">Descargar factura PDF</a>
		</div>
	</div>
</div>

<style>
	body {
		background-color: #F4F6F9;
		font-family: 'Poppins', sans-serif;
	}

	.factura {
		margin-top: 50px;
	}

	.invoice {
		max-width: 900px;
		margin: auto;
	}

	.card {
		border-radius: 10px;
		box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
	}

	.table th, .table td {
		vertical-align: middle;
	}

	.badge {
		font-size: 1rem;
		padding: 0.5rem 1rem;
	}

	.alert-info {
		background-color: #e3f2fd;
		border: none;
	}
</style>
